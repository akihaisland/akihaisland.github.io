import{I as le}from"./InfoHead-ae1a6abb.js";import{e as U,u as ie,f as ne,k as ce,l as k,g as p,w as j,m as _e,j as re,x as J,o as c,c as _,a as e,i as K,h as Q,t as l,F as m,r as g,y as M,n as x,s as ve,v as de,q as E,d as ue,D as he,H as q,p as pe,b as me,_ as X}from"./index-e61785bb.js";import{L as ge}from"./LoadingBox-c4de8375.js";const r=B=>(pe("data-v-fe353352"),B=B(),me(),B),we={class:"anime_play_area"},fe={class:"video_page_pc_cont"},ye={class:"main_cont_place"},be={class:"left_col"},ke={class:"col_content"},xe={class:"video_outer_box"},Ce={class:"video_inner_box"},Le={key:0,id:"pc_player",ref:"pc_player"},$e={class:"video_desc_box"},Ze={class:"video_title"},Be={class:"video_blurb"},Ie={class:"anime_srcs_select_box"},Se=["onClick"],Ve={class:"select_episode_box"},Ne=["onClick"],He={class:"right_col"},Me={class:"col_content"},qe={class:"score_box"},Pe={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 36 36"},De=["stroke-dasharray","stroke"],Ae={class:"score_data"},Te={class:"score_dig"},je={class:"rank_dig"},Ee={class:"tags_box"},Fe={class:"attr_pair"},Re=r(()=>e("span",{class:"attr_title"}," 片名: ",-1)),ze={class:"attr_pair"},Oe=r(()=>e("span",{class:"attr_title"}," 简介: ",-1)),We={class:"attr_pair"},Ge=r(()=>e("span",{class:"attr_title"}," 总集数: ",-1)),Je={class:"attr_title"},Ke={class:"video_page_mobile_cont"},Qe={class:"video_inner_box"},Ue={key:0,id:"pc_player",ref:"pc_player"},Xe={class:"video_info_bar"},Ye={class:"video_desc_box"},es={class:"video_btn_box"},ss=ue('<div class="video_btn" data-v-fe353352><svg xmlns="http://www.w3.org/2000/svg" id="Layer_1" data-name="Layer 1" viewBox="0 0 24 24" width="512" height="512" data-v-fe353352><path d="M17,12h-4v-2h4v2Zm0,3h-6v2h6v-2Zm4,6V2h-5.171c-.413-1.164-1.525-2-2.829-2h-2c-1.304,0-2.416,.836-2.829,2H3V21c0,1.654,1.346,3,3,3h12c1.654,0,3-1.346,3-3ZM10,4v-1c0-.551,.449-1,1-1h2c.551,0,1,.449,1,1v1h5V21c0,.551-.449,1-1,1H6c-.551,0-1-.449-1-1V4h5Zm-1,11h-2v2h2v-2Zm.838-3.481l2.759-2.702-1.399-1.429-2.533,2.48-1.241-1.192-1.386,1.442,1.45,1.393c.326,.326,.754,.488,1.181,.488,.425,0,.848-.161,1.168-.481Z" data-v-fe353352></path></svg></div><div class="video_btn" data-v-fe353352><svg xmlns="http://www.w3.org/2000/svg" id="Layer_1" data-name="Layer 1" viewBox="0 0 24 24" data-v-fe353352><path d="m24,5.917l-3.3,1.909,1.326,4.029-.75.523-3.261-2.521-3.275,2.532-.721-.543,1.304-4.076-3.323-1.848v-.922h4.35l1.178-4.5h.97l1.176,4.5h4.326v.917Zm-19-.917v2h5v-2h-5Zm7,4h-7v2h7v-2Zm-7,6h7v-2h-7v2Zm14,3h3v3c0,1.654-1.346,3-3,3H3.5c-1.93,0-3.5-1.57-3.5-3.5V3C0,1.346,1.346,0,3,0h11.13c-.915.507-1.716,1.189-2.366,2H3c-.551,0-1,.448-1,1v17.5c0,.827.673,1.5,1.5,1.5s1.5-.673,1.5-1.5v-2.5h12v-3.067c.327.043.661.067,1,.067s.672-.028,1-.069v3.069Zm1,2H7v.5c0,.536-.122,1.045-.338,1.5h12.338c.551,0,1-.448,1-1v-1Z" data-v-fe353352></path></svg></div>',2),ts={class:"video_btn score_btn"},os=r(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",id:"Layer_1","data-name":"Layer 1",viewBox:"0 0 24 24"},[e("g",{style:{translate:"0 3px"}},[e("path",{d:"m20.5,11h-2c-.539,0-1.044.133-1.5.351v-4.851c0-1.93-1.57-3.5-3.5-3.5h-3c-1.93,0-3.5,1.57-3.5,3.5v2.851c-.456-.219-.961-.351-1.5-.351h-2c-1.93,0-3.5,1.57-3.5,3.5v5c0,1.93,1.57,3.5,3.5,3.5h17c1.93,0,3.5-1.57,3.5-3.5v-3c0-1.93-1.57-3.5-3.5-3.5ZM2,17.5v-5c0-.827.673-1.5,1.5-1.5h2c.827,0,1.5.673,1.5,1.5v6.5h-3.5c-.827,0-1.5-.673-1.5-1.5Zm7-11c0-.827.673-1.5,1.5-1.5h3c.827,0,1.5.673,1.5,1.5v12.5h-6V6.5Zm13,11c0,.827-.673,1.5-1.5,1.5h-3.5v-4.5c0-.827.673-1.5,1.5-1.5h2c.827,0,1.5.673,1.5,1.5v3Z"})])],-1)),as={class:"score_digit"},ls={class:"sel_srcs_box"},is=r(()=>e("div",{class:"playing_bar"},null,-1)),ns=r(()=>e("div",{class:"playing_bar"},null,-1)),cs=r(()=>e("div",{class:"playing_bar"},null,-1)),_s=[is,ns,cs],rs={class:"select_episode_area"},vs={class:"select_episode_board"},ds={class:"select_episode_box"},us=["onClick"],hs=r(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[e("path",{d:"M7 0 L13 10 L7 20",style:{"stroke-width":"2",fill:"transparent"}})],-1)),ps=[hs],ms={class:"show_title"},gs=r(()=>e("div",{class:"show_title_content"}," 选择集数 ",-1)),ws=r(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[e("path",{d:"M0 15 L10 5 L20 15",style:{stroke:"#61666D","stroke-width":"2",fill:"transparent"}})],-1)),fs=[ws],ys={class:"full_select_episode_board"},bs=["onClick"],ks={class:"show_title"},xs=r(()=>e("div",{class:"show_title_content"}," 视频详情 ",-1)),Cs=r(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[e("path",{d:"M0 15 L10 5 L20 15",style:{stroke:"#61666D","stroke-width":"2",fill:"transparent"}})],-1)),Ls=[Cs],$s={class:"video_detail_content"},Zs={class:"score_box"},Bs={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 36 36"},Is=["stroke-dasharray","stroke"],Ss={class:"score_data"},Vs={class:"score_dig"},Ns={class:"rank_dig"},Hs={class:"attr_pair"},Ms=r(()=>e("div",{class:"attr_title"}," 片名 ",-1)),qs={class:"attr_val"},Ps={class:"attr_pair"},Ds=r(()=>e("div",{class:"attr_title"}," 简介 ",-1)),As={class:"attr_val"},Ts={class:"attr_pair"},js=r(()=>e("div",{class:"attr_title"}," 总集数 ",-1)),Es={class:"attr_val"},Fs={class:"attr_title"},Rs={class:"attr_val"},zs={class:"show_title"},Os=r(()=>e("div",{class:"show_title_content"}," 选择资源 ",-1)),Ws=r(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[e("path",{d:"M0 15 L10 5 L20 15",style:{stroke:"#61666D","stroke-width":"2",fill:"transparent"}})],-1)),Gs=[Ws],Js={class:"full_select_src_board"},Ks=["onClick"],Qs=U({__name:"AnimePlay",setup(B){const b=ie(),$=ne(),Y=ce();let I;const C=k(""),ee=k([]),u=k([]),i=k({}),d=k(0),v=k(0),F=k(!0),w=p(()=>v.value<u.value.length&&v.value>=0?u.value[v.value].srcs.vod_play_url:[]),h=p(()=>v.value<u.value.length&&v.value>=0?u.value[v.value].srcs:{vod_name:"正在载入",vod_year:"正在载入",vod_area:"正在载入",vod_class:"正在载入",vod_blurb:"正在载入"}),se=p(()=>{if(v.value<u.value.length&&v.value>=0){const s=u.value[v.value].srcs_idx;return $.anime_srcs_list[s]}else return"正在载入..."}),P=p(()=>{const s=[];for(let a=0;a<u.value.length;a++){const t=$.anime_srcs_list[u.value[a].srcs_idx];s.push(t)}return s});function D(s){s>=0&&s<P.value.length&&(v.value=s),(d.value>=w.value.length||d.value<0)&&(d.value=0)}function S(s){s<w.value.length&&s>=0&&(d.value=s)}async function V(){I!=null&&I!=null?(console.log("url: ",w.value[d.value].ep_link),I.switchVideo({url:w.value[d.value].ep_link,type:"hls",customType:{hls:function(s,a){if(q.isSupported()){const t=new q;t.loadSource(s.src),t.attachMedia(s)}else s.canPlayType("application/vnd.apple.mpegurl")}}},void 0)):(await J(),I=new he({container:document.getElementById("pc_player"),screenshot:!0,video:{url:w.value[d.value].ep_link,type:"hls",customType:{hls:function(s,a){if(q.isSupported()){const t=new q;t.loadSource(s.src),t.attachMedia(s)}else s.canPlayType("application/vnd.apple.mpegurl")}}}})),C.value!=""&&Y.play_anime(C.value,v.value,d.value,w.value[d.value].ep_name,u.value[0].srcs.vod_pic)}j(()=>b.query,()=>{V()}),j(()=>d.value,()=>{V()}),j(()=>v.value,()=>{V()});const te=p(()=>{const s=[];let a=0;if(i.value.tags!=null&&i.value.tags!=null){for(let o=0;o<i.value.tags.length;o++)a+=i.value.tags[o].count;let t=0;a>0&&(t=a/i.value.tags.length);for(let o=0;o<i.value.tags.length;o++)if(i.value.tags[o].count>=t){let n=i.value.tags[o].name;i.value.tags[o].count>0&&(n+="("+i.value.tags[o].count+")"),s.push({name:i.value.tags[o].name,count:i.value.tags[o].count,show:n})}}return s}),R=p(()=>{let s="";return i.value.summary!=null&&i.value.summary!=null&&(s=i.value.summary),s}),z=p(()=>{let s="";return i.value.name!=null&&i.value.name!=null&&(s=i.value.name),s}),O=p(()=>{let s="";return i.value.total_episodes!=null&&i.value.total_episodes!=null&&(s+=i.value.total_episodes),s}),W=p(()=>{const s=[];if(i.value.infobox!=null&&i.value.infobox!=null)for(let a=0;a<i.value.infobox.length;a++){const t=i.value.infobox[a],o={title:t.key,value:""};if(typeof t.value=="string")o.value=t.value;else for(let n=0;n<t.value.length;n++)n>0&&(o.value+=", "),o.value+=t.value[n].v;s.push(o)}return s}),A=["rgba(255,128,102,1)","rgba(255.0,156.22222222222223,102.0,1.0)","rgba(255.0,184.44444444444446,102.0,1.0)","rgba(255.0,212.66666666666666,102.0,1.0)","rgba(255.0,240.88888888888889,102.0,1.0)","rgba(240.88888888888889,255.0,102.0,1.0)","rgba(212.66666666666669,255.0,102.0,1.0)","rgba(184.44444444444446,255.0,102.0,1.0)","rgba(156.22222222222223,255.0,102.0,1.0)","rgba(128.0,255.0,102.0,1.0)"],L=p(()=>{let s=0,a=0,t=[];if(i.value.rating!=null&&i.value.rating!=null){const n=i.value.rating;s=n.score,a=n.rank;let Z=0,y=0;if(n.total!=0)for(const H of Object.values(n.count)){y+=1;let G=10;n.total!=0&&(G=H/n.total*100),t.push({stroke:"0,"+Z+",100",color:A[y-1]}),Z+=G}else{for(let H=0;H<9;H++)t.push({stroke:"0,0,100",color:A[y-1]});t.push({stroke:"1",color:A[y-1]})}}let o="#"+a;return a==0&&(o="No Rank Info"),{score:s,rank:o,score_pie:t}}),N=k(0);function f(s){N.value=s}function oe(s){const a=[];for(let n=0;n<s.length;n++){const Z=s[n].srcs.vod_class.split(",");for(let y=0;y<Z.length;y++)Z[y]!=""&&a.push(Z[y])}const t=Array.from(new Set(a)),o=[];for(let n=0;n<t.length;n++)o.push({name:t[n],count:0});return o}async function ae(s){let a=!1;for(let o=0;o<s.length;o++)if(s[o].srcs.vod_class.includes("动画")){a=!0;break}if(a)try{i.value=await $.obtain_anime_bgm_detail(C.value);return}catch{console.log("[Error] No Bangumi Data!")}const t={date:s[0].srcs.vod_time,images:{small:s[0].srcs.vod_pic,grid:s[0].srcs.vod_pic,large:s[0].srcs.vod_pic,medium:s[0].srcs.vod_pic,common:s[0].srcs.vod_pic},summary:s[0].srcs.vod_blurb,name:s[0].srcs.vod_name,name_cn:s[0].srcs.vod_name,tags:oe(s),rating:{rank:0,total:0,count:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0},score:s[0].srcs.vod_douban_score},total_episodes:s[0].srcs.vod_serial,infobox:[{key:"演员",value:s[0].srcs.vod_actor},{key:"导演",value:s[0].srcs.vod_director},{key:"编剧",value:s[0].srcs.vod_writer}]};i.value=t}let T=!0;return _e(async()=>{window.innerWidth<780&&(T=!1),"animeName"in b.query?C.value=b.query.animeName:C.value="",C.value==""&&re.push("/anime/search");const s=await $.obtain_anime_detail(C.value);u.value=$.get_anime_srcs(s.anime),ee.value=s.srcs_classes,ae(u.value).then(()=>{F.value=!1}),"srcIdx"in b.query&&D(Number(b.query.srcIdx)),"epIdx"in b.query&&S(Number(b.query.epIdx)),await J(),V()}),(s,a)=>(c(),_("div",we,[e("div",fe,[e("div",ye,[e("div",be,[e("div",ke,[e("div",xe,[e("div",Ce,[K(T)?(c(),_("div",Le,null,512)):Q("",!0)])]),e("div",$e,[e("h2",Ze,l(h.value.vod_name),1),e("div",Be,l(h.value.vod_year)+" | "+l(h.value.vod_area)+" | "+l(h.value.vod_class)+" | "+l(h.value.vod_blurb)+" ",1)]),e("div",Ie,[(c(!0),_(m,null,g(P.value,(t,o)=>(c(),_("span",{class:x(["anime_src_item",{select_item:v.value==o}]),key:o,onClick:n=>D(o)},l(t),11,Se))),128))]),e("div",Ve,[(c(!0),_(m,null,g(w.value,(t,o)=>(c(),_("span",{class:x(["episode_item",{select_item:d.value==o}]),key:o,onClick:n=>S(o)},l(t.ep_name),11,Ne))),128))])])]),e("div",He,[e("div",Me,[e("div",qe,[(c(),_("svg",Pe,[(c(!0),_(m,null,g(L.value.score_pie,(t,o)=>(c(),_("circle",{cx:"18",cy:"18",r:"16","stroke-width":"4",key:o,"stroke-dasharray":t.stroke,fill:"transparent",stroke:t.color},null,8,De))),128))])),e("div",Ae,[e("div",Te,l(L.value.score),1),e("div",je,l(L.value.rank),1)])]),e("div",Ee,[(c(!0),_(m,null,g(te.value,(t,o)=>(c(),_("span",{class:"tag_item",key:o},l(t.show),1))),128))]),e("div",Fe,[Re,M(" "+l(z.value),1)]),e("div",ze,[Oe,M(" "+l(R.value),1)]),e("div",We,[Ge,M(" "+l(O.value),1)]),(c(!0),_(m,null,g(W.value,(t,o)=>(c(),_("div",{class:"attr_pair",key:o},[e("span",Je,l(t.title)+": ",1),M(" "+l(t.value),1)]))),128))])])])]),e("div",Ke,[e("div",{class:"video_outer_box",onClick:a[0]||(a[0]=t=>f(0))},[e("div",Qe,[K(T)?Q("",!0):(c(),_("div",Ue,null,512))])]),e("div",Xe,[e("div",Ye,[e("h2",{class:"video_title",onClick:a[1]||(a[1]=t=>f(3))},l(h.value.vod_name),1),e("div",{class:"video_blurb",onClick:a[2]||(a[2]=t=>f(3))},l(h.value.vod_year)+" | "+l(h.value.vod_area)+" | "+l(h.value.vod_class)+" | "+l(h.value.vod_blurb),1)]),e("div",es,[ss,e("div",ts,[os,e("div",as,l(L.value.score),1)])]),e("div",ls,[e("div",{class:"sel_src_title",onClick:a[3]||(a[3]=t=>f(2))},l(se.value),1),e("div",{class:"now_play_anime",onClick:a[4]||(a[4]=t=>f(2))},_s)]),e("div",rs,[e("div",vs,[e("div",ds,[(c(!0),_(m,null,g(w.value,(t,o)=>(c(),_("span",{class:x(["episode_item",{select_item:d.value==o}]),key:o,onClick:n=>S(o)},l(t.ep_name),11,us))),128))])]),e("div",{class:"episodes_complete_show_btn",onClick:a[5]||(a[5]=t=>f(1))},ps)]),e("div",{class:x(["episodes_complete_show",{c_show:N.value==1}])},[e("div",ms,[gs,e("div",{class:"show_title_btn",onClick:a[6]||(a[6]=t=>f(0))},fs)]),e("div",ys,[(c(!0),_(m,null,g(w.value,(t,o)=>(c(),_("div",{class:x(["full_episode_item",{select_item:d.value==o}]),key:o,onClick:n=>S(o)},l(t.ep_name),11,bs))),128))])],2),e("div",{class:x(["video_detail_show",{c_show:N.value==3}])},[e("div",ks,[xs,e("div",{class:"show_title_btn",onClick:a[7]||(a[7]=t=>f(0))},Ls)]),e("div",$s,[e("div",Zs,[(c(),_("svg",Bs,[(c(!0),_(m,null,g(L.value.score_pie,(t,o)=>(c(),_("circle",{cx:"18",cy:"18",r:"16","stroke-width":"4",key:o,"stroke-dasharray":t.stroke,fill:"transparent",stroke:t.color},null,8,Is))),128))])),e("div",Ss,[e("div",Vs,l(L.value.score),1),e("div",Ns,l(L.value.rank),1)])]),e("div",Hs,[Ms,e("div",qs,l(z.value),1)]),e("div",Ps,[Ds,e("div",As,l(R.value),1)]),e("div",Ts,[js,e("div",Es,l(O.value),1)]),(c(!0),_(m,null,g(W.value,(t,o)=>(c(),_("div",{class:"attr_pair",key:o},[e("div",Fs,l(t.title),1),e("div",Rs,l(t.value),1)]))),128))])],2),e("div",{class:x(["srcs_complete_show",{c_show:N.value==2}])},[e("div",zs,[Os,e("div",{class:"show_title_btn",onClick:a[8]||(a[8]=t=>f(0))},Gs)]),e("div",Js,[(c(!0),_(m,null,g(P.value,(t,o)=>(c(),_("div",{class:x(["full_src_item",{select_item:v.value==o}]),key:o,onClick:n=>D(o)},l(t),11,Ks))),128))])],2)])]),ve(E(ge,{style:{width:"3em",height:"3em"}},null,512),[[de,F.value]])]))}}),Us=X(Qs,[["__scopeId","data-v-fe353352"]]),Xs={class:"page_box"},Ys={class:"head_where"},et={class:"page_where"},st=U({__name:"AnimePlayPage",setup(B){return(b,$)=>(c(),_("div",Xs,[e("div",Ys,[E(le)]),e("div",et,[E(Us)])]))}}),lt=X(st,[["__scopeId","data-v-dd9a528e"]]);export{lt as default};
