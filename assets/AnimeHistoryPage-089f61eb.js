import{I as L}from"./InfoHead-079b6179.js";import{e as M,k as H,u as N,g as f,o as i,c as _,a as n,F as v,r as w,i as k,h as $,j as x,t as h,n as B,m as b}from"./index-52246f2c.js";const q={class:"history_show"},I={class:"history_item_list"},A=n("div",{class:"page_title"}," 历史记录 ",-1),P=["onClick"],V={class:"history_img_box"},T=["src"],j={class:"history_info_box"},z={class:"item_title"},E={class:"item_progress"},R={class:"item_play_time"},S={class:"page_router_box"},G={class:"page_sel_btn_box"},J=n("svg",{version:"1.0",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[n("path",{d:"M5 0, L5 20",fill:"transparent",stroke:"red","stroke-width":"1.5"}),n("path",{d:"M15 0, L5 10, L15 20",fill:"transparent",stroke:"red","stroke-width":"1.5"})],-1),K=[J],O=["title","onClick"],Q=n("svg",{version:"1.0",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[n("path",{d:"M15 0, L15 20",fill:"transparent",stroke:"red","stroke-width":"1.5"}),n("path",{d:"M5 0, L15 10, L5 20",fill:"transparent",stroke:"red","stroke-width":"1.5"})],-1),U=[Q],W=M({__name:"AnimeHistory",setup(Y){function m(s,o,t){x.push("/anime/play?animeName="+s+"&srcIdx="+o+"&epIdx="+t)}const a=H();function C(s){const o=new Date,t=new Date(s),r=t.getHours(),e=t.getMinutes();if(D(o,t))return`昨天 ${r}:${e}`;if(F(o,t))return`${r}:${e}`;const l=t.getFullYear(),c=t.getMonth()+1,u=t.getDate();return`${l}年${c}月${u}日 ${r}:${e}`}function D(s,o){const t=s.getFullYear(),r=s.getMonth(),e=s.getDate(),l=o.getFullYear(),c=o.getMonth(),u=o.getDate();return t===l&&r===c&&e-u===1}function F(s,o){const t=s.getFullYear(),r=s.getMonth(),e=s.getDate(),l=o.getFullYear(),c=o.getMonth(),u=o.getDate();return t===l&&r===c&&e===u}const p=N(),y=f(()=>"page"in p.query?Number(p.query.page):1),g=f(()=>{let s=1,o=!0,t=!0;"page"in p.query&&(s=Number(p.query.page)),s==1&&(o=!1),s==a.history_page_num&&(t=!1),a.history_page_num==0&&(o=!1,t=!1);const r=[];if(a.history_page_num<=5)for(let e=1;e<=a.history_page_num;e++)r.push(e);else if(s<=3)for(let e=1;e<=5;e++)r.push(e);else if(s+2>a.history_page_num)for(let e=a.history_page_num-4;e<=a.history_page_num;e++)r.push(e);else for(let e=s-2;e<=s+2;e++)r.push(e);return{first_page:o,last_page:t,pages2show:r}});function d(s){s>=1&&s<=a.history_page_num&&x.push("/anime/history?page="+s)}return(s,o)=>(i(),_("div",q,[n("div",I,[A,(i(!0),_(v,null,w(k(a).reverse_hist(y.value),(t,r)=>(i(),_("div",{class:"history_item",key:r,onClick:e=>m(t.name_cn,t.play_src_idx,t.play_progress.ep_idx)},[n("div",V,[n("img",{src:t.img_link,alt:""},null,8,T)]),n("div",j,[n("div",z,h(t.name_cn),1),n("div",E," 观看到 "+h(t.play_progress.ep_title),1),n("div",R,h(C(t.play_time)),1)])],8,P))),128)),n("div",S,[n("div",G,[g.value.first_page?(i(),_("button",{key:0,class:"page_sel_btn",title:"First Page",onClick:o[0]||(o[0]=t=>d(0))},K)):$("",!0),(i(!0),_(v,null,w(g.value.pages2show,(t,r)=>(i(),_("button",{class:B(["page_sel_btn",{now_page:t==y.value}]),key:r,title:"Page "+t,onClick:e=>d(t)},h(t),11,O))),128)),g.value.last_page?(i(),_("button",{key:1,class:"page_sel_btn",title:"Last page",onClick:o[1]||(o[1]=t=>d(k(a).history_len))},U)):$("",!0)])])])]))}}),X={class:"page_content"},Z={class:"head_box"},tt={class:"history_content_place"},nt=M({__name:"AnimeHistoryPage",setup(Y){return(m,a)=>(i(),_("div",X,[n("div",Z,[b(L)]),n("div",tt,[b(W)])]))}});export{nt as default};
